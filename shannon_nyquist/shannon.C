#include <TMath.h>

  float yval[] = {-2.700000, -3.599999, -3.799999, -4, -4.199999, -9.899999, -14.69999, -25.20000, -31.10000, -44.5, -47.29999, -48.90000, -48, -43, -40.90000, -35.29999, -33.79999, -27.60000, -25.70000, -21.10000, -20.10000, -17.89999, -16.5, -17.5, -16.89999, -15.39999, -14.10000, -9.199999, -6.400000, -1.799999, -0.899999, 1.2000000, 2.0999999, 1.7000000, 1.7000000, 0.5, 0, -0.899999, -2.400000 };

  float xval[] = { 79.199996, 79.400001, 79.599998, 79.800003, 80, 80.199996, 80.400001, 80.599998, 80.800003, 81, 81.199996, 81.400001, 81.599998, 81.800003, 82, 82.199996, 82.400001, 82.599998, 82.800003, 83, 83.199996, 83.400001, 83.599998, 83.800003, 84, 84.199996, 84.400001, 84.599998, 84.800003, 85, 85.199996, 85.400001, 85.599998, 85.800003, 85.900001, 86.099998, 86.300003, 86.5, 86.699996 };

Double_t sinc_expansion(Double_t *x, Double_t *par)
{
  Double_t xx = x[0];
  Double_t yy = 0.;
  Double_t T = 0.2;	// period
  for (int isample=0; isample<39; isample++)
    {
       if ( isample%4 != 0 ) continue;
       Double_t n = TMath::Nint(xval[isample]/T);
       Double_t XX = 3.14159*((xx-n*T)/T);
       yy += yval[isample]*(sin(XX)/XX);
    }
  return yy;
}

void shannon()
{
  TF1 *sinc = new TF1("sinc","sin(3.14159*x)/(3.14159*x)",-10,10);
  //sinc->Draw();
  cout << sinc->Integral(-100,100) << endl;

  TGraph *gr = new TGraph(39,xval,yval);
  gr->SetMarkerStyle(20);
  gr->Draw("ap");

  TF1 *f = new TF1("f",sinc_expansion,0,180,0);
  f->SetLineColor(4);
  f->SetNpx(400);
  f->Draw("same");
}
